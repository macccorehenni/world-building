/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var I=Object.defineProperty;var ie=Object.getOwnPropertyDescriptor;var se=Object.getOwnPropertyNames;var ae=Object.prototype.hasOwnProperty;var re=(t,e)=>{for(var n in e)I(t,n,{get:e[n],enumerable:!0})},oe=(t,e,n,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of se(e))!ae.call(t,i)&&i!==n&&I(t,i,{get:()=>e[i],enumerable:!(s=ie(e,i))||s.enumerable});return t};var le=t=>oe(I({},"__esModule",{value:!0}),t);var Pe={};re(Pe,{default:()=>T});module.exports=le(Pe);var k=require("obsidian");var M=t=>{let e=[],n=0,s=/`([^`]+)`/g,i;for(;(i=s.exec(t))!==null;)i.index>n&&e.push({isCode:!1,content:t.substring(n,i.index)}),e.push({isCode:!0,content:i[0]}),n=i.index+i[0].length;n<t.length&&e.push({isCode:!1,content:t.substring(n)});let o=/\[\[(.*?)(?:\|(.*?))?\]\]/g;return e.map(a=>a.isCode?a.content:a.content.replace(o,(r,u,d)=>d||u)).join("")};var W={},w=(t,e)=>{let n=e+"/";return e&&t.startsWith(n)?t.slice(n.length).split("/")[0]||"":t.split("/")[0]||""},H=(t,e=!1)=>{let n={children:new Map};for(let s of t){let i=n,o=e?s.toLowerCase():s;for(let g of o){let a=i.children.get(g);a||(a={children:new Map},i.children.set(g,a)),i=a}i.candidate=s}return n},x=(t,e,n=!1)=>{let s=t.filter(l=>!l.preventLinking),i=e?`${e}/`:null,o=i?.length||0,g=s.map(l=>{let p={full:l.path,short:null,restrictNamespace:l.restrictNamespace,namespace:w(l.path,e)};return i&&l.path.startsWith(i)&&(p.short=l.path.slice(o)),p}),a=new Map;for(let{full:l,short:p,restrictNamespace:c,namespace:m}of g){a.set(l,{canonical:l,restrictNamespace:c,namespace:m});let h=l.lastIndexOf("/");if(h!==-1){let f=l.slice(h+1);(n||/^[\p{Script=Han}\p{Script=Hiragana}\p{Script=Katakana}\p{Script=Hangul}]+$/u.test(f))&&(a.set(f,{canonical:l,restrictNamespace:c,namespace:m}),n&&a.set(f.toLowerCase(),{canonical:l,restrictNamespace:c,namespace:m}))}p&&a.set(p,{canonical:l,restrictNamespace:c,namespace:m})}for(let l of s)if(l.aliases){let p=null;i&&l.path.startsWith(i)&&(p=l.path.slice(o));for(let c of l.aliases){let m=p&&c===p?c:`${l.path}|${c}`;a.has(c)||a.set(c,{canonical:m,restrictNamespace:l.restrictNamespace,namespace:w(l.path,e)})}}let r=Array.from(a.keys()),u=n?r.flatMap(l=>{let p=l.lastIndexOf("/"),c=p===-1?l:l.slice(p+1);return[l,c.toLowerCase()]}):r,d=H(u,n);return{candidateMap:a,trie:d}};if(W.vitest){let{it:t,expect:e,describe:n}=W.vitest;n("getEffectiveNamespace",()=>{t("should return the first directory after the baseDir",()=>{e(w("pages/docs/file","pages")).toBe("docs"),e(w("pages/home/readme","pages")).toBe("home")}),t("should return the first segment if baseDir is not found",()=>{e(w("docs/file")).toBe("docs"),e(w("home/readme")).toBe("home")})}),n("buildTrie",()=>{t("should build a Trie with the given words",()=>{let i=H(["hello","world","hi"]);e(i.children.has("h")).toBe(!0),e(i.children.has("w")).toBe(!0),e(i.children.get("h")?.children.has("e")).toBe(!0),e(i.children.get("h")?.children.get("i")?.candidate).toBe("hi")})}),n("buildCandidateTrie",()=>{t("should build a candidate map and trie",()=>{let s=[{path:"pages/docs/readme",restrictNamespace:!1,aliases:["intro"]},{path:"pages/home/index",restrictNamespace:!1,aliases:[]}],{candidateMap:i,trie:o}=x(s,"pages");e(i.has("pages/docs/readme")).toBe(!0),e(i.has("docs/readme")).toBe(!0),e(i.get("intro")?.canonical).toBe("pages/docs/readme|intro"),e(o.children.has("d")).toBe(!0),e(o.children.has("h")).toBe(!0)})})}var b={PROTECTED:/(```[\s\S]*?```|`[^`]*`|\[\[[^\]]+\]\]|\[[^\]]+\]\([^)]+\)|https?:\/\/[^\s]+)/g,DATE_FORMAT:/^\d{4}-\d{2}-\d{2}$/,MONTH_NOTE:/^[0-9]{1,2}$/,CJK:/[\p{Script=Han}\p{Script=Hiragana}\p{Script=Katakana}]/u,CJK_CANDIDATE:/^[\p{Script=Han}\p{Script=Hiragana}\p{Script=Katakana}\p{Script=Hangul}\s\d]+$/u,KOREAN:/^[\p{Script=Hangul}]+$/u,JAPANESE:/^[\p{Script=Han}\p{Script=Hiragana}\p{Script=Katakana}\s\d]+$/u,URL:/^(https?:\/\/[^\s]+)/,PROTECTED_LINK:/^\s*(\[\[[^\]]+\]\]|\[[^\]]+\]\([^)]+\))\s*$/,KOREAN_SUFFIX:/^(이다\.?)/,KOREAN_PARTICLES:/^(는|은)/,JAPANESE_PARTICLES:/^(가|는|을|에|서|와|로부터|까지|보다|로|의|나|도|또한)/,TABLE_SEPARATOR:/^[|:\s-]+$/,WORD_BOUNDARY:/[\p{L}\p{N}_/-]/u,WHITESPACE:/[\t\n\r ]/},U=t=>t===void 0||b.CJK.test(t)?!0:!b.WORD_BOUNDARY.test(t)||b.WHITESPACE.test(t),_=t=>b.MONTH_NOTE.test(t)&&parseInt(t,10)>=1&&parseInt(t,10)<=12,ce=t=>b.PROTECTED_LINK.test(t),ge=t=>b.CJK.test(t),J=t=>b.CJK_CANDIDATE.test(t),ue=t=>b.KOREAN.test(t),de=t=>b.JAPANESE.test(t)&&!b.KOREAN.test(t),j=new WeakMap,G=(t,e)=>{let n=j.get(t);n||(n=new Map,j.set(t,n));let s=e?"ignoreCase":"normal",i=n.get(s);if(i)return i;let o=new Map;for(let[g,a]of t.entries()){let r=g.lastIndexOf("/");if(r===-1)continue;let u=g.slice(r+1),d=e?u.toLowerCase():u,l=o.get(d);l||(l=[],o.set(d,l)),l.push([g,a])}return n.set(s,o),o},pe=(t,e)=>e?w(t,e):t.split("/")[0]||"",N=(t,e)=>e&&t.startsWith(e+"/")?t.slice((e+"/").length):t,K=t=>{let e=t.indexOf("|"),n=e!==-1;if(n){let s=t.slice(0,e),i=t.slice(e+1);return{linkPath:s,alias:i,hasAlias:n}}return{linkPath:t,alias:"",hasAlias:n}},E=(t,e,n={})=>{if(!n.preventSelfLinking)return!1;let{linkPath:s}=K(t.canonical),i=N(s,n.baseDir),o=N(e,n.baseDir);return i===o},he=(t,e)=>{if(!e||e.length===0||!t.includes("/"))return!1;for(let n of e)if(t===n||t.startsWith(n+"/"))return!0;return!1},$=(t,e,n={})=>{let{linkPath:s,alias:i,hasAlias:o}=K(t.canonical),g=N(s,n.baseDir),a=he(g,n.removeAliasInDirs);if(o)return a?g:`${g}|${i}`;if(g.includes("/")){if(a)return g;let u=g.split("/").pop()||e;if(n.ignoreCase&&e.includes("/")){let d=e.split("/").pop();d&&(u=d)}else n.ignoreCase&&(u=e);return`${g}|${u}`}return n.ignoreCase?e.toLowerCase()===g.toLowerCase()?e:`${g}|${e}`:e!==g?`${g}|${e}`:g},F=(t,e)=>(e&&t.includes("|")&&(t=t.replace(/\|/g,"\\|")),`[[${t}]]`),me=(t,e)=>e.ignoreDateFormats&&b.DATE_FORMAT.test(t)?!0:_(t),fe=t=>{let e=t.trim();return!e||!e.includes("|")?!1:e.startsWith("|")&&e.endsWith("|")&&b.TABLE_SEPARATOR.test(e)?!0:e.startsWith("|")&&e.endsWith("|")},V=(t,e)=>{let n=t.lastIndexOf(`
`,e-1)+1;n===0&&t[0]!==`
`&&(n=0);let s=t.indexOf(`
`,e);s===-1&&(s=t.length);let i=t.slice(n,s);return fe(i)},Le=(t,e,n,s,i,o={})=>X(t,e,n,G(n,o.ignoreCase),i,s,o),be=(t,e,n,s,i,o)=>{let g=t[e-1];if(!U(g))return null;let a=null,r=Math.min(t.length-e,100),u="",d="";for(let f=1;f<=r;f++){let C=e+f,D=t[e+f-1];u+=D,d=o.ignoreCase?d+D.toLowerCase():u;let v=n.get(d);if(!v)continue;let y=t[C];U(y)&&(me(u,o)||(a={word:u,length:f,key:d,candidateList:v}))}if(!a)return null;let l=a.candidateList.filter(([,f])=>!(f.restrictNamespace&&f.namespace!==i)),p=null;if(l.length===1)p=l[0][1];else if(l.length>1){let f=we(l,s,o);f&&(p=f[1])}if(!p)return null;if(E(p,s,o))return{result:a.word,newIndex:e+a.length};let c=$(p,a.word,o),m=V(t,e);return{result:F(c,m),newIndex:e+a.length}},ke=(t,e,n,s,i,o={})=>{let g=t.slice(e+n.length),a=g.match(b.KOREAN_SUFFIX);if(a){if(E(s,i,o))return{result:n+a[0],newIndex:e+n.length+a[0].length};let r=$(s,n,o);return{result:F(r,!1)+a[0],newIndex:e+n.length+a[0].length}}return g.match(b.KOREAN_PARTICLES)?{result:t[e],newIndex:e+1}:null},we=(t,e,n={})=>{let s=null,i=-1,o=e.includes("/")?e.slice(0,e.lastIndexOf("/")):"",g=o?o.split("/"):[];for(let[a,r]of t){let u=a.lastIndexOf("/"),l=a.slice(0,u).split("/"),p=0;for(let c=0;c<Math.min(l.length,g.length)&&l[c]===g[c];c++)p++;if(p>i)i=p,s=[a,r];else if(p===i&&s!==null)if(o===""&&n.baseDir){let c=n.baseDir+"/",m=C=>C.startsWith(c)?C.slice(c.length).split("/").length-1:1/0,h=m(a),f=m(s[0]);(h<f||h===f&&a.length<s[0].length)&&(s=[a,r])}else{let m=s[0].slice(0,s[0].lastIndexOf("/")).split("/");(l.length<m.length||l.length===m.length&&a.length<s[0].length)&&(s=[a,r])}}return s},X=(t,e,n,s,i,o,g={})=>{let a="",r=0;e:for(;r<t.length;){if(t[r]==="h"&&t.slice(r,r+4)==="http"){let c=t.slice(r).match(b.URL);if(c){a+=c[0],r+=c[0].length;continue}}let u=e,d=null,l=r,p="";for(;l<t.length;){let c=t[l],m=g.ignoreCase?c.toLowerCase():c;p+=c;let h=u.children.get(m);if(!h)break;u=h,u.candidate&&(J(p)||U(t[l+1]))&&(d={candidate:u.candidate,length:l-r+1}),l++}if(d){let c=p.slice(0,d.length);if(g.ignoreDateFormats&&b.DATE_FORMAT.test(c)){a+=c,r+=d.length;continue e}if(_(c)){a+=c,r+=d.length;continue}let m=d.candidate,h=n.get(m),f=t.substring(r,r+d.length);if(h){if(E(h,i,g)){a+=c,r+=c.length;continue e}if(ue(c)){let R=ke(t,r,c,h,i,g);if(R){a+=R.result,r=R.newIndex;continue e}}if(!J(c)){let R=r>0?t[r-1]:void 0,ne=r+c.length<t.length?t[r+c.length]:void 0;if(!U(R)||!U(ne)){a+=t[r],r++;continue e}}if(de(c)&&(r+c.length<t.length?t.slice(r+c.length,r+c.length+10):"").match(b.JAPANESE_PARTICLES),g.namespaceResolution&&h.restrictNamespace&&h.namespace!==o){a+=c,r+=c.length;continue e}let y=$(h,f,g),ee=V(t,r),te=F(y,ee);a+=te,r+=c.length;continue e}}if(g.namespaceResolution){let c=be(t,r,s,i,o,g);if(c){a+=c.result,r=c.newIndex;continue e}}a+=t[r],r++}return a},O=({body:t,linkResolverContext:{filePath:e,trie:n,candidateMap:s},settings:i={minCharCount:0,namespaceResolution:!0,baseDir:void 0,ignoreDateFormats:!0}})=>{if(t.length<=(i.minCharCount??0)||(t=t.normalize("NFC"),ce(t)))return t;let o=G(s,i.ignoreCase),g=pe(e,i.baseDir),a=h=>ge(h)?Le(h,n,s,g,e,i):X(h,n,s,o,e,g,i),r=/^>[ \t]*\[![\w-]+\].*?(\n>.*?)*(?=\n(?!>)|$)/gm,u=[],d=0,l=t.replace(r,h=>{let f=`__CALLOUT_${d}__`;return u.push({placeholder:f,content:h}),d++,f}),p="",c=0,m;for(b.PROTECTED.lastIndex=0;(m=b.PROTECTED.exec(l))!==null;){let h=m.index,f=l.slice(c,h);p+=a(f),p+=m[0],c=h+m[0].length,m[0].length===0&&b.PROTECTED.lastIndex++}p+=a(l.slice(c));for(let{placeholder:h,content:f}of u)p=p.replace(h,f);return p};var q=({body:t,urlTitleMap:e})=>{if(e.size===0)return t;let n=t,s=Array.from(e.keys()).sort((i,o)=>o.length-i.length);for(let i of s){let o=e.get(i);if(!o)continue;let g=`[${o}](${i})`,a=0,r=[];for(;a<n.length;){let u=n.indexOf(i,a);if(u===-1){r.push(n.substring(a));break}r.push(n.substring(a,u));let d=!0,l=n.substring(u-2,u),p=n[u+i.length];if(l==="]("&&p===")"&&(d=!1),d){let c=n.substring(0,u);if((c.match(/(?<!\\)`/g)||[]).length%2!==0){let h=c.lastIndexOf("`");h!==-1&&!c.substring(h+1).includes("`")&&(d=!1)}}d?r.push(g):r.push(i),a=u+i.length}n=r.join("")}return n};var Re=/<title[^>]*>([^<]+)<\/title>/i,z=t=>{let e=t.match(Re);return e&&e[1]?e[1].trim():""};var Ce=/https?:\/\/[^\s<>"'`)]+/g,Ue=/[.,;!?\]}]+$/,Y=(t,e)=>{let n=new Set,s,i=[],o=/^(?:```|~~~)[^\r\n]*?\r?\n([\s\S]*?)\r?\n^(?:```|~~~)$/gm,g;for(;(g=o.exec(t))!==null;)i.push({start:g.index,end:g.index+g[0].length});for(o.lastIndex=0;(s=Ce.exec(t))!==null;){let a=s[0],r=s.index,u=!1;for(let l of i)if(r>=l.start&&r<l.end){u=!0;break}if(u)continue;let d=!0;if(r>=2){let l=r+a.length;l<t.length&&t[l]===")"&&t.substring(r-2,r)==="]("&&(d=!1)}if(d&&r>=1){let l=t[r-1],p=t[r+a.length];l==="<"&&p===">"&&(d=!1)}if(d){let l=t.substring(0,r);if((l.match(/(?<!\\)`/g)||[]).length%2!==0){let c=l.lastIndexOf("`");c!==-1&&!l.substring(c+1).includes("`")&&(d=!1)}}if(d){let l=a,p=!0;if(e&&e.length>0)try{let m=new URL(a).hostname;e.some(h=>m===h||m.endsWith(`.${h}`))&&(p=!1)}catch(c){console.warn(`Failed to parse URL for domain check: ${a}`,c),p=!1}if(p){let c=a.replace(Ue,"");c.includes("://")?l=c:(l=a,console.warn(`URL cleaning potentially broke the URL: ${a} -> ${c}`))}p&&n.add(l)}}return n};function P(t,e){try{let n=new URL(t);if(!Te(n,e.jiraURLs)||t.includes("?"))return t;let s=De(n);if(!s)return t;let i=Ae(n,s);return Se(n,s,i)}catch{return t}}function De(t){let e=t.pathname.split("/").filter(Boolean);if(e[0]!=="browse"||e.length!==2)return null;let n=e[1].split("-");return n.length!==2?null:{project:n[0],issueId:n[1]}}function Ae(t,e){return`${t.origin}/browse/${e.project}-${e.issueId}`}function Se(t,e,n){return`[[${t.hostname.split(".")[1]}/jira/${e.project}/${e.issueId}]] [\u{1F517}](${n})`}function Te(t,e){return e.some(n=>{let s=n.replace(/^https?:\/\//,"").replace(/\/$/,"");return t.hostname===s})}function B(t,e){if(!e.formatLinearURLs)return t;try{let n=t;t.startsWith("linear://")&&(n=t.replace("linear://","https://linear.app/"));let s=new URL(n);if(!xe(s))return t;let i=ve(s);if(!i)return t;let o=ye(i);return Ie(i,o)}catch{return t}}function ve(t){let e=t.pathname.split("/").filter(Boolean);if(e.length<3)return null;let[n,s,i]=e;return s!=="issue"||!/^[A-Z]+-\d+$/.test(i)?null:{workspace:n,issueId:i}}function ye(t){return`https://linear.app/${t.workspace}/issue/${t.issueId}`}function Ie(t,e){return`[[linear/${t.workspace}/${t.issueId}]] [\u{1F517}](${e})`}function xe(t){return t.hostname==="linear.app"}function Z(t,e){try{let n=new URL(t);if(!Fe(n,e.githubEnterpriseURLs))return t;let s=Ne(n);if(!s)return t;let i=Ee(n,s);return $e(s,i)}catch{return t}}function Ne(t){let e=t.pathname.split("/").filter(Boolean);if(e.length<2)return null;let[n,s,i,o]=e,g={owner:n,repository:s};return Oe(t)&&(g.type=i,g.id=o),g}function Ee(t,e){if(e.type&&e.id){let n=`/${e.owner}/${e.repository}/${e.type}/${e.id}`;return`${t.origin}${n}`}return`${t.origin}/${e.owner}/${e.repository}`.replace(/\/$/,"")}function $e(t,e){let o=`[[${new URL(e).hostname!=="github.com"?"ghe":"github"}/${t.owner}/${t.repository}`;return t.type&&t.id&&(o+=`/${t.type}/${t.id}`),o+=`]] [\u{1F517}](${e})`,o}function Fe(t,e){return t.hostname==="github.com"?!0:e.some(n=>{let s=n.replace(/^https?:\/\//,"").replace(/\/$/,"");return t.hostname===s})}function Oe(t){let e=t.pathname.toLowerCase();return e.includes("/pull/")||e.includes("/issues/")}var A=(t,e,n)=>{let s=/(?<!\[\[.*)(https?:\/\/[^\s\]]+)(?!.*\]\])/g;return t=t.replace(s,i=>n(i,e)),t};var L=require("obsidian"),S=class extends L.PluginSettingTab{plugin;constructor(e,n){super(e,n),this.plugin=n}display(){let{containerEl:e}=this;e.empty(),new L.Setting(e).setName("General").setHeading(),new L.Setting(e).setName("Format on save").setDesc("When enabled, the file will be automatically formatted (links replaced) when saving.").addToggle(n=>{n.setValue(this.plugin.settings.formatOnSave).onChange(async s=>{this.plugin.settings.formatOnSave=s,await this.plugin.saveData(this.plugin.settings)})}),new L.Setting(e).setName("Run Obsidian Linter before formatting").setDesc("When enabled, Obsidian Linter will be executed before Automatic Linker formatting. This requires the Obsidian Linter plugin to be installed.").addToggle(n=>{n.setValue(this.plugin.settings.runLinterBeforeFormatting).onChange(async s=>{this.plugin.settings.runLinterBeforeFormatting=s,await this.plugin.saveData(this.plugin.settings)})}),new L.Setting(e).setName("Base directory").setDesc("Enter the directory to be treated as the base directory. For example, 'pages' will allow links to be formatted without the 'pages/' prefix. If you want to achieve more complex behavior, consider using Obsidian Linter Plugin.").addText(n=>{n.setPlaceholder(`e.g. pages
`).setValue(this.plugin.settings.baseDir).onChange(async s=>{this.plugin.settings.baseDir=s,await this.plugin.saveData(this.plugin.settings)})}),new L.Setting(e).setName("Minimum character count").setDesc("If the content is below this character count, the links will not be replaced.").addText(n=>{n.setPlaceholder("e.g. 4").setValue(this.plugin.settings.minCharCount.toString()).onChange(async s=>{let i=parseInt(s);isNaN(i)||(this.plugin.settings.minCharCount=i,await this.plugin.saveData(this.plugin.settings))})}),new L.Setting(e).setName("Consider aliases").setDesc("When enabled, aliases will be taken into account when processing links. Note: A restart is required for changes to take effect.").addToggle(n=>{n.setValue(this.plugin.settings.considerAliases).onChange(async s=>{this.plugin.settings.considerAliases=s,await this.plugin.saveData(this.plugin.settings)})}),new L.Setting(e).setName("Automatic namespace resolution").setDesc("When enabled, the plugin will automatically resolve namespaces for shorthand links. If multiple candidates share the same shorthand, the candidate with the most common path segments relative to the current file will be selected.").addToggle(n=>{n.setValue(this.plugin.settings.namespaceResolution).onChange(async s=>{this.plugin.settings.namespaceResolution=s,await this.plugin.saveData(this.plugin.settings)})}),new L.Setting(e).setName("Ignore date formats").setDesc("When enabled, links that match date formats (e.g. 2025-02-10) will be ignored. This helps maintain compatibility with Obsidian Tasks.").addToggle(n=>{n.setValue(this.plugin.settings.ignoreDateFormats).onChange(async s=>{this.plugin.settings.ignoreDateFormats=s,await this.plugin.saveData(this.plugin.settings)})}),new L.Setting(e).setName("Ignore case").setDesc("When enabled, link matching will be case-insensitive. The original case of the text will be preserved in the link.").addToggle(n=>{n.setValue(this.plugin.settings.ignoreCase).onChange(async s=>{this.plugin.settings.ignoreCase=s,await this.plugin.saveData(this.plugin.settings)})}),new L.Setting(e).setName("Prevent self-linking").setDesc("When enabled, text will not be linked to its own file. For example, the word 'VPN' inside VPN.md will not be converted to a link.").addToggle(n=>{n.setValue(this.plugin.settings.preventSelfLinking).onChange(async s=>{this.plugin.settings.preventSelfLinking=s,await this.plugin.saveData(this.plugin.settings)})}),new L.Setting(e).setName("Exclude directories from automatic linking").setDesc("Directories to be excluded from automatic linking, one per line (e.g. 'Templates')").addTextArea(n=>{n.setPlaceholder(`Templates
Archive`).setValue(this.plugin.settings.excludeDirsFromAutoLinking.join(`
`)).onChange(async s=>{let i=s.split(`
`).map(o=>o.trim()).filter(Boolean);this.plugin.settings.excludeDirsFromAutoLinking=i,await this.plugin.saveData(this.plugin.settings)})}),new L.Setting(e).setName("Remove aliases in directories").setDesc("Directories where link aliases should be removed, one per line (e.g. 'dir' will convert [[dir/xxx|yyy]] to [[dir/xxx]]). This affects both auto-generated aliases and frontmatter aliases.").addTextArea(n=>{n.setPlaceholder(`dir1
dir2/subdir`).setValue(this.plugin.settings.removeAliasInDirs.join(`
`)).onChange(async s=>{let i=s.split(`
`).map(o=>o.trim()).filter(Boolean);this.plugin.settings.removeAliasInDirs=i,await this.plugin.saveData(this.plugin.settings)})}),new L.Setting(e).setName("URL Formatting for GitHub").setHeading(),new L.Setting(e).setName("Format GitHub URLs on save").setDesc("When enabled, GitHub URLs will be formatted when saving the file.").addToggle(n=>{n.setValue(this.plugin.settings.formatGitHubURLs).onChange(async s=>{this.plugin.settings.formatGitHubURLs=s,await this.plugin.saveData(this.plugin.settings)})}),new L.Setting(e).setName("GitHub Enterprise URLs").setDesc("Add your GitHub Enterprise URLs, one per line (e.g. github.enterprise.com)").addTextArea(n=>{n.setPlaceholder(`github.enterprise.com
github.company.com`).setValue(this.plugin.settings.githubEnterpriseURLs.join(`
`)).onChange(async s=>{let i=s.split(`
`).map(o=>o.trim()).filter(Boolean);this.plugin.settings.githubEnterpriseURLs=i,await this.plugin.saveData(this.plugin.settings)}),n.inputEl.rows=4,n.inputEl.cols=50}),new L.Setting(e).setName("URL Formatting for Jira").setHeading(),new L.Setting(e).setName("Format JIRA URLs on save").setDesc("When enabled, JIRA URLs will be formatted when saving the file.").addToggle(n=>{n.setValue(this.plugin.settings.formatJiraURLs).onChange(async s=>{this.plugin.settings.formatJiraURLs=s,await this.plugin.saveData(this.plugin.settings)})}),new L.Setting(e).setName("JIRA URLs").setDesc("Add your JIRA URLs, one per line (e.g. jira.enterprise.com)").addTextArea(n=>{n.setPlaceholder(`jira.enterprise.com
jira.company.com`).setValue(this.plugin.settings.jiraURLs.join(`
`)).onChange(async s=>{let i=s.split(`
`).map(o=>o.trim()).filter(Boolean);this.plugin.settings.jiraURLs=i,await this.plugin.saveData(this.plugin.settings)}),n.inputEl.rows=4,n.inputEl.cols=50}),new L.Setting(e).setName("URL Formatting for Linear").setHeading(),new L.Setting(e).setName("Format Linear URLs on save").setDesc("When enabled, Linear URLs will be formatted when saving the file.").addToggle(n=>{n.setValue(this.plugin.settings.formatLinearURLs).onChange(async s=>{this.plugin.settings.formatLinearURLs=s,await this.plugin.saveData(this.plugin.settings)})}),new L.Setting(e).setName("URL Replacement with Title").setHeading(),new L.Setting(e).setName("Replace URL with title").setDesc("When enabled, raw URLs will be replaced with [Page Title](URL). Requires fetching the URL content.").addToggle(n=>{n.setValue(this.plugin.settings.replaceUrlWithTitle).onChange(async s=>{this.plugin.settings.replaceUrlWithTitle=s,await this.plugin.saveData(this.plugin.settings)})}),new L.Setting(e).setName("Igonre domains").setDesc("Ignore domains for replacing URLs with titles, one per line (e.g. x.com)").addTextArea(n=>{n.setPlaceholder("").setValue(this.plugin.settings.replaceUrlWithTitleIgnoreDomains.join(`
`)).onChange(async s=>{let i=s.split(`
`).map(o=>o.trim()).filter(Boolean);this.plugin.settings.replaceUrlWithTitleIgnoreDomains=i,await this.plugin.saveData(this.plugin.settings)}),n.inputEl.rows=4,n.inputEl.cols=50}),new L.Setting(e).setName("Debug").setHeading(),new L.Setting(e).setName("Show load notice").setDesc("Display a notice when markdown files are loaded.").addToggle(n=>{n.setValue(this.plugin.settings.showNotice).onChange(async s=>{this.plugin.settings.showNotice=s,await this.plugin.saveData(this.plugin.settings)})}),new L.Setting(e).setName("Debug mode").setDesc("When enabled, debug information will be logged to the console.").addToggle(n=>{n.setValue(this.plugin.settings.debug).onChange(async s=>{this.plugin.settings.debug=s,await this.plugin.saveData(this.plugin.settings)})})}};var Q={formatOnSave:!1,baseDir:"pages",showNotice:!1,minCharCount:0,considerAliases:!1,namespaceResolution:!1,ignoreDateFormats:!0,formatGitHubURLs:!0,githubEnterpriseURLs:[],formatJiraURLs:!0,jiraURLs:[],formatLinearURLs:!0,debug:!1,ignoreCase:!1,replaceUrlWithTitle:!1,replaceUrlWithTitleIgnoreDomains:[],excludeDirsFromAutoLinking:[],preventSelfLinking:!1,removeAliasInDirs:[],runLinterBeforeFormatting:!1};var T=class extends k.Plugin{settings;trie=null;candidateMap=null;originalSaveCallback;urlTitleMap=new Map;constructor(e,n){super(e,n)}async modifyLinks(){let e=this.app.workspace.getActiveFile();if(!(!e||this.app.metadataCache.getFileCache(e)?.frontmatter?.["automatic-linker-disabled"]===!0))try{if(this.settings.formatGitHubURLs&&await this.app.vault.process(e,i=>A(i,this.settings,Z)),this.settings.formatJiraURLs&&await this.app.vault.process(e,i=>A(i,this.settings,P)),this.settings.formatLinearURLs&&await this.app.vault.process(e,i=>A(i,this.settings,B)),this.settings.replaceUrlWithTitle){let i=await this.app.vault.read(e),{contentStart:o}=(0,k.getFrontMatterInfo)(i),g=i.slice(o),a=Y(g,this.settings.replaceUrlWithTitleIgnoreDomains);for(let r of a){let u=await(0,k.request)(r),d=z(u);this.urlTitleMap.set(r,d)}await this.app.vault.process(e,r=>{let{contentStart:u}=(0,k.getFrontMatterInfo)(r),d=r.slice(0,u),l=r.slice(u),p=q({body:l,urlTitleMap:this.urlTitleMap});return d+p})}await this.app.vault.process(e,i=>{if(!this.trie||!this.candidateMap)return i;this.settings.debug&&(console.log("this.trie: ",this.trie),console.log("this.candidateMap: ",this.candidateMap),console.log(new Date().toISOString(),"modifyLinks started"),new k.Notice(`Automatic Linker: ${new Date().toISOString()} modifyLinks started.`));let{contentStart:o}=(0,k.getFrontMatterInfo)(i),g=i.slice(0,o),a=O({body:i.slice(o),linkResolverContext:{filePath:e.path.replace(/\.md$/,""),trie:this.trie,candidateMap:this.candidateMap},settings:{minCharCount:this.settings.minCharCount,namespaceResolution:this.settings.namespaceResolution,baseDir:this.settings.baseDir,ignoreDateFormats:this.settings.ignoreDateFormats,ignoreCase:this.settings.ignoreCase,preventSelfLinking:this.settings.preventSelfLinking,removeAliasInDirs:this.settings.removeAliasInDirs}});return this.settings.debug&&(console.log(new Date().toISOString(),"modifyLinks finished"),new k.Notice(`Automatic Linker: ${new Date().toISOString()} modifyLinks finished.`)),g+a})}catch(i){console.error(i)}}async formatOnSave(){this.settings.formatOnSave&&await this.modifyLinks()}async mofifyLinksSelection(){let e=this.app.workspace.getActiveFile();if(!e)return;let n=this.app.workspace.activeEditor;if(!n)return;let s=n.editor;if(!s)return;let i=s.getSelection();if(!this.trie||!this.candidateMap)return;let o=O({body:i,linkResolverContext:{filePath:e.path.replace(/\.md$/,""),trie:this.trie,candidateMap:this.candidateMap},settings:{minCharCount:this.settings.minCharCount,namespaceResolution:this.settings.namespaceResolution,baseDir:this.settings.baseDir,ignoreDateFormats:this.settings.ignoreDateFormats,ignoreCase:this.settings.ignoreCase,preventSelfLinking:this.settings.preventSelfLinking,removeAliasInDirs:this.settings.removeAliasInDirs}});s.replaceSelection(o)}async onload(){await this.loadSettings(),this.addSettingTab(new S(this.app,this));let e=()=>{let o=this.app.vault.getMarkdownFiles().filter(r=>{let u=r.path.replace(/\.md$/,"");return!this.settings.excludeDirsFromAutoLinking.some(d=>u.startsWith(d+"/")||u===d)}).map(r=>{let u=r.path.replace(/\.md$/,""),d=this.app.metadataCache.getFileCache(r)?.frontmatter,l=d?.["automatic-linker-restrict-namespace"]===!0||d?.["automatic-linker-limited-namespace"]===!0,p=d?.["automatic-linker-prevent-linking"]===!0,c=(()=>{if(this.settings.considerAliases){let m=this.app.metadataCache.getFileCache(r)?.frontmatter;return(0,k.parseFrontMatterAliases)(m)}else return null})();return{path:u,aliases:c,restrictNamespace:l,preventLinking:p}});o.sort((r,u)=>u.path.length-r.path.length);let{candidateMap:g,trie:a}=x(o,this.settings.baseDir);this.candidateMap=g,this.trie=a,this.settings.showNotice&&new k.Notice(`Automatic Linker: Loaded all markdown files. (${o.length} files)`)};this.app.workspace.onLayoutReady(()=>{e(),this.settings.debug&&(console.log("Automatic Linker: Built all markdown files."),new k.Notice("Automatic Linker: Built all markdown files.")),this.registerEvent(this.app.vault.on("delete",()=>e())),this.registerEvent(this.app.vault.on("create",()=>e())),this.registerEvent(this.app.vault.on("rename",()=>e()))}),this.addCommand({id:"link-current-file",name:"Link current file",editorCallback:async()=>{try{await this.modifyLinks()}catch(i){console.error(i)}}}),this.addCommand({id:"rebuild-all-files",name:"rebuild all files",editorCallback:async()=>{try{e(),this.settings.debug&&(console.log("Automatic Linker: Built all markdown files."),new k.Notice("Automatic Linker: Built all markdown files."))}catch(i){console.error(i)}}}),this.addCommand({id:"link-selection",name:"Link selection",editorCallback:async()=>{try{await this.mofifyLinksSelection()}catch(i){console.error(i)}}}),this.addCommand({id:"copy-file-content-without-links",name:"Copy file content without links",editorCallback:async()=>{let i=this.app.workspace.getActiveFile();if(!i)return;let o=await this.app.vault.read(i),{contentStart:g}=(0,k.getFrontMatterInfo)(o),a=o.slice(g),r=M(a);navigator.clipboard.writeText(r)}});let n=this.app?.commands?.commands?.["editor:save-file"],s=n?.checkCallback;typeof s=="function"&&(this.originalSaveCallback=s),n.checkCallback=async i=>{if(i)return s?.(i);this.settings.runLinterBeforeFormatting&&await this.app?.commands?.executeCommandById("obsidian-linter:lint-file"),await this.formatOnSave()}}async onunload(){let e=this.app?.commands?.commands?.["editor:save-file"];e&&this.originalSaveCallback&&(e.checkCallback=this.originalSaveCallback)}async loadSettings(){this.settings=Object.assign({},Q,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}};

/* nosourcemap */